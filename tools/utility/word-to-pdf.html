<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <title>Word to PDF Converter - QuickToolsHub</title>
    <meta name="description" content="Free online Word to PDF converter. Convert DOC, DOCX files to PDF instantly!">
    <meta name="tool-name" content="Word to PDF Converter">
    <meta name="tool-category" content="Utility Tools">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Word Processing Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        html { scroll-behavior: smooth; }
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { 
            background: linear-gradient(to bottom, #2563eb, #9333ea);
            border-radius: 5px;
        }
        
        button, input, label {
            -webkit-tap-highlight-color: rgba(0,0,0,0.1);
            touch-action: manipulation;
        }
        
        button { cursor: pointer; }
        
        @media (max-width: 768px) {
            button { min-height: 48px !important; }
        }
        
        .drop-zone {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .drop-zone.dragover {
            border-color: #4caf50 !important;
            background: #e8f5e9 !important;
            transform: scale(1.02);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }
        
        #previewContent {
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.6;
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <div id="universal-header"></div>
    <div id="universal-breadcrumb"></div>
    
    <section class="py-8 md:py-12">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto">
                
                <!-- Header -->
                <div class="text-center mb-6 md:mb-8">
                    <div class="inline-block bg-gradient-to-r from-green-500 to-blue-500 text-white px-4 py-2 rounded-full text-xs md:text-sm font-bold mb-3 md:mb-4">
                        <i class="fas fa-fire mr-1 md:mr-2"></i>POPULAR TOOL
                    </div>
                    <h2 class="text-2xl md:text-4xl font-bold text-gray-800 mb-2 md:mb-4">üìÑ Word to PDF Converter</h2>
                    <p class="text-sm md:text-lg text-gray-600 px-4">Convert Word documents (DOCX, DOC, TXT) to PDF instantly!</p>
                </div>

                <!-- Upload Section -->
                <div class="bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-4 md:p-8 mb-6 border-2 border-green-200">
                    <h3 class="text-xl md:text-2xl font-bold text-center mb-4 md:mb-6 text-gray-800">Upload Your File</h3>
                    
                    <div class="drop-zone bg-white border-3 border-dashed border-green-400 rounded-lg p-6 md:p-8 text-center" id="dropZone">
                        <div class="text-4xl md:text-6xl mb-3 md:mb-4">üìù</div>
                        <h4 class="text-base md:text-xl font-bold mb-2">Drag & Drop or Click to Upload</h4>
                        <p class="text-xs md:text-sm text-gray-600 mb-3 md:mb-4">Supports: DOCX, DOC, TXT</p>
                        <label for="fileInput" class="inline-block bg-gradient-to-r from-green-600 to-blue-600 text-white px-6 md:px-8 py-3 md:py-4 rounded-lg font-bold cursor-pointer hover:shadow-lg transition active:scale-95 text-sm md:text-base">
                            <i class="fas fa-file-upload mr-2"></i>Choose File
                        </label>
                        <input 
                            type="file" 
                            id="fileInput" 
                            accept=".doc,.docx,.txt" 
                            class="hidden"
                        >
                    </div>

                    <div class="grid grid-cols-3 gap-3 md:gap-4 mt-4 md:mt-6">
                        <div class="bg-white p-3 md:p-4 rounded-lg text-center border border-gray-200">
                            <i class="fas fa-file-word text-blue-600 text-xl md:text-2xl mb-2"></i>
                            <p class="font-bold text-xs md:text-sm">DOCX</p>
                        </div>
                        <div class="bg-white p-3 md:p-4 rounded-lg text-center border border-gray-200">
                            <i class="fas fa-file-word text-blue-700 text-xl md:text-2xl mb-2"></i>
                            <p class="font-bold text-xs md:text-sm">DOC</p>
                        </div>
                        <div class="bg-white p-3 md:p-4 rounded-lg text-center border border-gray-200">
                            <i class="fas fa-file-alt text-gray-600 text-xl md:text-2xl mb-2"></i>
                            <p class="font-bold text-xs md:text-sm">TXT</p>
                        </div>
                    </div>
                </div>

                <!-- File Info -->
                <div id="fileInfo" class="hidden bg-blue-50 border-2 border-blue-200 rounded-lg p-3 md:p-4 mb-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-file-word text-blue-600 text-xl md:text-2xl mr-3"></i>
                            <div>
                                <p class="font-bold text-sm md:text-base text-gray-800" id="fileName">File Name</p>
                                <p class="text-xs md:text-sm text-gray-600" id="fileSize">File Size</p>
                            </div>
                        </div>
                        <button type="button" onclick="resetTool()" class="text-red-600 hover:text-red-700 font-bold text-sm md:text-base">
                            <i class="fas fa-times mr-1"></i>Remove
                        </button>
                    </div>
                </div>

                <!-- Processing -->
                <div id="processing" class="hidden bg-white rounded-xl p-6 md:p-8 text-center shadow-lg mb-6">
                    <div class="spinner mx-auto mb-4"></div>
                    <h3 class="text-lg md:text-xl font-bold mb-2">‚ö° Converting to PDF...</h3>
                    <p class="text-sm md:text-base text-gray-600" id="processingMsg">Processing your document...</p>
                    <div class="bg-gray-200 h-6 md:h-8 rounded-full overflow-hidden mt-4 max-w-md mx-auto">
                        <div id="progressFill" class="bg-gradient-to-r from-green-600 to-blue-600 h-full flex items-center justify-center text-white font-bold text-xs md:text-sm transition-all" style="width: 0%">0%</div>
                    </div>
                </div>

                <!-- Results -->
                <div id="results" class="hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-6">
                        <!-- Preview -->
                        <div class="bg-white rounded-xl p-4 md:p-6 shadow-lg">
                            <h3 class="font-bold text-base md:text-lg mb-3 md:mb-4 flex items-center">
                                <i class="fas fa-eye text-blue-600 mr-2"></i>Document Preview
                            </h3>
                            <div id="previewContent" class="border-2 border-gray-200 rounded-lg p-3 md:p-4 bg-gray-50 text-sm md:text-base">
                                <p class="text-gray-500 text-center">Preview loading...</p>
                            </div>
                        </div>

                        <!-- Download -->
                        <div class="bg-white rounded-xl p-4 md:p-6 shadow-lg">
                            <h3 class="font-bold text-base md:text-lg mb-3 md:mb-4 flex items-center">
                                <i class="fas fa-file-pdf text-red-600 mr-2"></i>PDF Ready
                            </h3>
                            
                            <div class="bg-green-50 border-2 border-green-200 rounded-lg p-4 md:p-6 mb-4">
                                <div class="flex items-center mb-4">
                                    <i class="fas fa-check-circle text-green-600 text-2xl md:text-3xl mr-3"></i>
                                    <div>
                                        <p class="font-bold text-sm md:text-base text-gray-800">Conversion Complete!</p>
                                        <p class="text-xs md:text-sm text-gray-600">Ready to download</p>
                                    </div>
                                </div>

                                <button type="button" onclick="downloadPDF()" class="w-full bg-gradient-to-r from-red-600 to-red-700 text-white px-4 md:px-6 py-3 md:py-4 rounded-lg font-bold hover:shadow-lg transition text-sm md:text-base active:scale-95">
                                    <i class="fas fa-download mr-2"></i>Download PDF
                                </button>
                            </div>

                            <button type="button" onclick="resetTool()" class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 md:px-6 py-2 md:py-3 rounded-lg font-bold hover:shadow-lg transition text-sm md:text-base active:scale-95">
                                <i class="fas fa-redo mr-2"></i>Convert Another File
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Features -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4">
                    <div class="bg-blue-50 p-3 md:p-4 rounded-lg border-2 border-blue-200 text-center">
                        <i class="fas fa-file-word text-blue-600 text-xl md:text-2xl mb-2"></i>
                        <h3 class="font-bold text-xs md:text-sm mb-1">Word Support</h3>
                        <p class="text-xs text-gray-600 hidden md:block">DOC & DOCX</p>
                    </div>
                    <div class="bg-green-50 p-3 md:p-4 rounded-lg border-2 border-green-200 text-center">
                        <i class="fas fa-bolt text-green-600 text-xl md:text-2xl mb-2"></i>
                        <h3 class="font-bold text-xs md:text-sm mb-1">Fast Convert</h3>
                        <p class="text-xs text-gray-600 hidden md:block">Instant</p>
                    </div>
                    <div class="bg-purple-50 p-3 md:p-4 rounded-lg border-2 border-purple-200 text-center">
                        <i class="fas fa-shield-alt text-purple-600 text-xl md:text-2xl mb-2"></i>
                        <h3 class="font-bold text-xs md:text-sm mb-1">Secure</h3>
                        <p class="text-xs text-gray-600 hidden md:block">Private</p>
                    </div>
                    <div class="bg-orange-50 p-3 md:p-4 rounded-lg border-2 border-orange-200 text-center">
                        <i class="fas fa-gift text-orange-600 text-xl md:text-2xl mb-2"></i>
                        <h3 class="font-bold text-xs md:text-sm mb-1">Free</h3>
                        <p class="text-xs text-gray-600 hidden md:block">Forever</p>
                    </div>
                </div>

                <!-- Note -->
                <div class="mt-6 bg-yellow-50 border-2 border-yellow-200 rounded-lg p-3 md:p-4">
                    <p class="text-xs md:text-sm text-gray-700">
                        <i class="fas fa-info-circle text-yellow-600 mr-2"></i>
                        <strong>Note:</strong> This tool extracts text and basic formatting from Word documents. For complex documents with images, tables, or advanced formatting, results may vary. Images and complex layouts will be converted to text format.
                    </p>
                </div>

            </div>
        </div>
    </section>
    
    <div id="universal-footer"></div>
    
    <script src="../../universal-template.js"></script>
    
    <script>
        let pdfBlob = null;
        let currentFileName = '';
        
        // Drag & Drop
        const dropZone = document.getElementById('dropZone');
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(e => {
            dropZone.addEventListener(e, (ev) => { ev.preventDefault(); ev.stopPropagation(); }, false);
            document.body.addEventListener(e, (ev) => { ev.preventDefault(); ev.stopPropagation(); }, false);
        });
        
        ['dragenter', 'dragover'].forEach(e => dropZone.addEventListener(e, () => dropZone.classList.add('dragover')));
        ['dragleave', 'drop'].forEach(e => dropZone.addEventListener(e, () => dropZone.classList.remove('dragover')));
        
        dropZone.addEventListener('drop', (e) => {
            if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
        });
        
        dropZone.addEventListener('click', function(e) {
            if (e.target.tagName !== 'LABEL' && e.target.tagName !== 'INPUT') {
                document.getElementById('fileInput').click();
            }
        });
        
        document.getElementById('fileInput').addEventListener('change', (e) => {
            if (e.target.files[0]) handleFile(e.target.files[0]);
        });
        
        function handleFile(file) {
            const validTypes = ['.doc', '.docx', '.txt'];
            const isValid = validTypes.some(ext => file.name.toLowerCase().endsWith(ext));
            
            if (!isValid) {
                alert('‚ùå Please upload a Word file (.doc, .docx) or text file (.txt)');
                return;
            }
            
            currentFileName = file.name.replace(/\.(doc|docx|txt)$/i, '');
            
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatBytes(file.size);
            document.getElementById('fileInfo').classList.remove('hidden');
            
            convertToPDF(file);
        }
        
        async function convertToPDF(file) {
            document.getElementById('processing').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');
            updateProgress(10, 'Reading file...');
            
            try {
                let htmlContent = '';
                
                if (file.name.toLowerCase().endsWith('.txt')) {
                    // Text file
                    const text = await file.text();
                    htmlContent = text.replace(/\n/g, '<br>');
                    updateProgress(50, 'Processing text...');
                    
                } else if (file.name.toLowerCase().endsWith('.docx')) {
                    // DOCX file
                    const arrayBuffer = await file.arrayBuffer();
                    updateProgress(30, 'Extracting content from Word...');
                    
                    const result = await mammoth.convertToHtml({arrayBuffer: arrayBuffer});
                    htmlContent = result.value;
                    updateProgress(60, 'Converting to PDF...');
                    
                } else if (file.name.toLowerCase().endsWith('.doc')) {
                    // Old DOC file - Try to read as text
                    alert('‚ÑπÔ∏è Old .doc format detected. This tool works best with .docx files.\n\nFor better results:\n1. Open the .doc file in Microsoft Word\n2. Save As ‚Üí choose .docx format\n3. Upload the .docx file here');
                    
                    const text = await file.text();
                    // Try to clean up binary data
                    htmlContent = text.replace(/[^\x20-\x7E\n]/g, '').replace(/\n/g, '<br>');
                    updateProgress(50, 'Processing...');
                }
                
                if (!htmlContent || htmlContent.length < 10) {
                    throw new Error('Could not extract content from file');
                }
                
                // Show preview
                document.getElementById('previewContent').innerHTML = htmlContent;
                updateProgress(80, 'Creating PDF...');
                
                // Create PDF using jsPDF
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4');
                
                // Create temp div for rendering
                const tempDiv = document.createElement('div');
                tempDiv.style.width = '190mm';
                tempDiv.style.padding = '10mm';
                tempDiv.style.backgroundColor = 'white';
                tempDiv.style.fontSize = '12pt';
                tempDiv.style.lineHeight = '1.6';
                tempDiv.style.fontFamily = 'Arial, sans-serif';
                tempDiv.innerHTML = htmlContent;
                
                // Append to body temporarily
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                document.body.appendChild(tempDiv);
                
                updateProgress(90, 'Rendering pages...');
                
                // Convert to canvas
                const canvas = await html2canvas(tempDiv, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });
                
                document.body.removeChild(tempDiv);
                
                // Add to PDF
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210;
                const pageHeight = 297;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft > 0) {
                    position = heightLeft - imgHeight;
                    doc.addPage();
                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                pdfBlob = doc.output('blob');
                updateProgress(100, 'Complete!');
                
                document.getElementById('processing').classList.add('hidden');
                document.getElementById('results').classList.remove('hidden');
                
            } catch (error) {
                console.error('Error:', error);
                alert('‚ùå Error converting file.\n\nPossible solutions:\n1. Try a .docx file instead of .doc\n2. Ensure the file is not corrupted\n3. Try a smaller file\n4. Use a different Word file');
                resetTool();
            }
        }
        
        function updateProgress(percent, message) {
            const fill = document.getElementById('progressFill');
            const msg = document.getElementById('processingMsg');
            fill.style.width = percent + '%';
            fill.textContent = percent + '%';
            if (message) msg.textContent = message;
        }
        
        function downloadPDF() {
            if (!pdfBlob) {
                alert('‚ùå PDF not ready');
                return;
            }
            
            const url = URL.createObjectURL(pdfBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = currentFileName + '.pdf';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            setTimeout(() => alert('‚úÖ PDF downloaded successfully!'), 300);
        }
        
        function resetTool() {
            document.getElementById('fileInfo').classList.add('hidden');
            document.getElementById('processing').classList.add('hidden');
            document.getElementById('results').classList.add('hidden');
            document.getElementById('fileInput').value = '';
            pdfBlob = null;
            currentFileName = '';
        }
        
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        console.log('‚úÖ Word to PDF Converter loaded!');
    </script>
    
</body>
</html>
